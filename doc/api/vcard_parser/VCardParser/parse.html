<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1, user-scalable=no">
  <meta name="description" content="API docs for the parse method from the VCardParser class, for the Dart programming language.">
  <title>parse method - VCardParser class - vcard_parser library - Dart API</title>

  
  <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500,400i,400,300|Source+Sans+Pro:400,300,700" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="stylesheet" href="../../static-assets/github.css">
  <link rel="stylesheet" href="../../static-assets/styles.css">
  <link rel="icon" href="../../static-assets/favicon.png">

</head>

<body data-base-href="../../"
      data-using-base-href="false">

<div id="overlay-under-drawer"></div>

<header id="title">
  <button id="sidenav-left-toggle" type="button">&nbsp;</button>
  <ol class="breadcrumbs gt-separated dark hidden-xs">
    <li><a href="../../index.html">flutter_contacts</a></li>
    <li><a href="../../vcard_parser/vcard_parser-library.html">vcard_parser</a></li>
    <li><a href="../../vcard_parser/VCardParser-class.html">VCardParser</a></li>
    <li class="self-crumb">parse method</li>
  </ol>
  <div class="self-name">parse</div>
  <form class="search navbar-right" role="search">
    <input type="text" id="search-box" autocomplete="off" disabled class="form-control typeahead" placeholder="Loading search...">
  </form>
</header>

<main>

  <div id="dartdoc-sidebar-left" class="col-xs-6 col-sm-3 col-md-2 sidebar sidebar-offcanvas-left">
    <header id="header-search-sidebar" class="hidden-l">
      <form class="search-sidebar" role="search">
        <input type="text" id="search-sidebar" autocomplete="off" disabled class="form-control typeahead" placeholder="Loading search...">
      </form>
    </header>
    
    <ol class="breadcrumbs gt-separated dark hidden-l" id="sidebar-nav">
      <li><a href="../../index.html">flutter_contacts</a></li>
      <li><a href="../../vcard_parser/vcard_parser-library.html">vcard_parser</a></li>
      <li><a href="../../vcard_parser/VCardParser-class.html">VCardParser</a></li>
      <li class="self-crumb">parse method</li>
    </ol>
    
    <h5>VCardParser class</h5>
    <ol>


    <li class="section-title"><a href="../../vcard_parser/VCardParser-class.html#constructors">Constructors</a></li>
    <li><a href="../../vcard_parser/VCardParser/VCardParser.html">VCardParser</a></li>

    <li class="section-title"> <a href="../../vcard_parser/VCardParser-class.html#instance-properties">Properties</a>
    </li>
    <li><a href="../../vcard_parser/VCardParser/buildingPhoto.html">buildingPhoto</a></li>
    <li><a href="../../vcard_parser/VCardParser/firstLineSeen.html">firstLineSeen</a></li>
    <li><a href="https://api.flutter.dev/flutter/dart-core/Object/hashCode.html">hashCode</a></li>
    <li><a href="../../vcard_parser/VCardParser/lastLineSeen.html">lastLineSeen</a></li>
    <li><a href="../../vcard_parser/VCardParser/photo.html">photo</a></li>
    <li><a href="https://api.flutter.dev/flutter/dart-core/Object/runtimeType.html">runtimeType</a></li>
    <li><a href="../../vcard_parser/VCardParser/version.html">version</a></li>

    <li class="section-title"><a href="../../vcard_parser/VCardParser-class.html#instance-methods">Methods</a></li>
    <li><a href="../../vcard_parser/VCardParser/decode.html">decode</a></li>
    <li><a href="../../vcard_parser/VCardParser/encode.html">encode</a></li>
    <li><a href="https://api.flutter.dev/flutter/dart-core/Object/noSuchMethod.html">noSuchMethod</a></li>
    <li><a href="../../vcard_parser/VCardParser/parse.html">parse</a></li>
    <li><a href="https://api.flutter.dev/flutter/dart-core/Object/toString.html">toString</a></li>

    <li class="section-title"><a href="../../vcard_parser/VCardParser-class.html#operators">Operators</a></li>
    <li><a href="https://api.flutter.dev/flutter/dart-core/Object/operator_equals.html">operator ==</a></li>



</ol>

  </div><!--/.sidebar-offcanvas-->

  <div id="dartdoc-main-content" class="col-xs-12 col-sm-9 col-md-8 main-content">
      <div><h1><span class="kind-method">parse</span> method </h1></div>

    <section class="multi-line-signature">
      <span class="returntype">void</span>
            <span class="name ">parse</span>
(<wbr><ol class="parameter-list"><li><span class="parameter" id="parse-param-content"><span class="type-annotation"><a href="https://api.flutter.dev/flutter/dart-core/String-class.html">String</a></span> <span class="parameter-name">content</span>, </span></li>
<li><span class="parameter" id="parse-param-contact"><span class="type-annotation"><a href="../../contact/Contact-class.html">Contact</a></span> <span class="parameter-name">contact</span></span></li>
</ol>)
      
    </section>
    
    <section class="summary source-code" id="source">
      <h2><span>Implementation</span></h2>
      <pre class="language-dart"><code class="language-dart">void parse(String content, Contact contact) {
  var lines = encode(content).split(&#39;\n&#39;).map((String x) =&gt; x.trim());
  for (final line in lines) {
    final parts = line.split(&#39;:&#39;);

    if (parts.length &gt;= 2 &amp;&amp; !buildingPhoto) {
      &#47;&#47; This is the normal case. Just go on normally.
    } else if (parts.length &lt; 2 &amp;&amp; !buildingPhoto) {
      &#47;&#47; Indicates invalid line, we&#39;ll just ignore it.
      continue;
    } else if (parts.length &lt; 2 &amp;&amp; buildingPhoto) {
      &#47;&#47; Continue building photo.
      photo += line;
      continue;
    } else if (parts.length &gt;= 2 &amp;&amp; buildingPhoto) {
      &#47;&#47; Stop building photo, and go on normally.
      buildingPhoto = false;
      contact.photo = base64.decode(decode(photo));
    }

    final firstPart = parts[0];
    final opParts = firstPart.split(&#39;;&#39;);
    final opComplete = opParts[0].toUpperCase();
    &#47;&#47; iOS exports repeated fields with custom labels like this:
    &#47;&#47; TEL;type=HOME;type=VOICE;type=pref:(333) 111-2222
    &#47;&#47; item2.TEL:(242) 164-5875
    &#47;&#47; item2.X-ABLabel:custom_label
    &#47;&#47; For simplicity we&#39;ll just drop the label in such cases
    final op = opComplete.split(&#39;.&#39;).last;
    var params = &lt;Param&gt;[];
    for (var part in opParts.sublist(1)) {
      final paramsParts = part.split(&#39;=&#39;);
      if (paramsParts.length &gt;= 2) {
        params.add(Param(paramsParts[0].toUpperCase(),
            paramsParts.sublist(1).join(&#39;=&#39;).toUpperCase()));
      }
    }
    final val = parts.sublist(1).join(&#39;:&#39;);

    if (op == &#39;BEGIN&#39;) {
      &#47;&#47; nothing to do
    } else if (op == &#39;END&#39;) {
      &#47;&#47; nothing to do
    } else if (op == &#39;VERSION&#39;) {
      if (val == &#39;2.1&#39;) {
        version = Version.V2_1;
      } else if (val == &#39;3&#39; || val == &#39;3.&#39; || val == &#39;3.0&#39;) {
        version = Version.V3;
      } else if (val == &#39;4&#39; || val == &#39;4.&#39; || val == &#39;4.0&#39;) {
        version = Version.V4;
      } else {
        &#47;&#47; invalid version, falling back on version 3
      }
    } else if (op == &#39;PRODID&#39;) {
      &#47;&#47; ignored
    } else if (op == &#39;N&#39;) {
      &#47;&#47; format is N:&lt;last&gt;;&lt;first&gt;;&lt;middle&gt;;&lt;prefix&gt;;&lt;suffix&gt;
      final parts = val.split(&#39;;&#39;);
      if (parts.length != 5) continue;
      contact.name.last = decode(parts[0]);
      contact.name.first = decode(parts[1]);
      contact.name.middle = decode(parts[2]);
      contact.name.prefix = decode(parts[3]);
      contact.name.suffix = decode(parts[4]);
    } else if (op == &#39;FN&#39;) {
      &#47;&#47; formatted name
      contact.displayName = decode(val);
    } else if (op == &#39;NICKNAME&#39;) {
      &#47;&#47; format is N:&lt;nickname 1&gt;[,&lt;nickname 2&gt;[,...]]
      final parts = val.split(&#39;,&#39;);
      contact.name.nickname = decode(parts[0]);
    } else if (op == &#39;TEL&#39;) {
      &#47;&#47; TEL;VALUE=uri;PREF=1;TYPE=&quot;voice,home&quot;:tel:+1-555-555-5555;ext=5555
      &#47;&#47; TEL;type=HOME;type=VOICE;type=pref:1 (234) 567-893
      &#47;&#47; TEL;type=WORK;type=VOICE:(987) 654-321
      &#47;&#47; TEL;TYPE=cell:(123) 555-583
      if (val.isEmpty) continue;
      Phone phone;
      if (val.startsWith(&#39;tel:&#39;)) {
        phone = Phone(decode(val.substring(4).split(&#39;;&#39;)[0]));
      } else {
        phone = Phone(decode(val));
      }
      for (var param in params) {
        if (param.key == &#39;TYPE&#39;) {
          if (param.value == &#39;HOME&#39;) {
            phone.label = PhoneLabel.home;
          } else if (param.value == &#39;MOBILE&#39; || param.value == &#39;CELL&#39;) {
            phone.label = PhoneLabel.mobile;
          } else if (param.value == &#39;WORK&#39;) {
            phone.label = PhoneLabel.work;
          } else if (param.value == &#39;PREF&#39;) {
            phone.isPrimary = true;
          }
        }
      }
      contact.phones.add(phone);
    } else if (op == &#39;EMAIL&#39;) {
      &#47;&#47; EMAIL;TYPE=work:jqpublic@xyz.example.com
      &#47;&#47; EMAIL;PREF=1:jane_doe@example.com
      &#47;&#47; EMAIL;type=INTERNET;type=HOME;type=pref:e@a.com
      &#47;&#47; EMAIL;type=INTERNET;type=WORK:e@b.com
      if (val.isEmpty) continue;
      var email = Email(decode(val));
      for (var param in params) {
        if (param.key == &#39;TYPE&#39;) {
          if (param.value == &#39;HOME&#39;) {
            email.label = EmailLabel.home;
          } else if (param.value == &#39;MOBILE&#39; || param.value == &#39;CELL&#39;) {
            email.label = EmailLabel.mobile;
          } else if (param.value == &#39;WORK&#39;) {
            email.label = EmailLabel.work;
          } else if (param.value == &#39;PREF&#39;) {
            email.isPrimary = true;
          }
        } else if (param.key == &#39;PREF&#39;) {
          email.isPrimary = true;
        }
      }
      contact.emails.add(email);
    } else if (op == &#39;ADR&#39;) {
      &#47;&#47; ADR;TYPE=home:;;123 Main St.;Springfield;IL;12345;USA
      &#47;&#47; item1.ADR;type=HOME;type=pref:;;52 rue des Fleurs;Libourne;;33500;France
      &#47;&#47; item2.ADR;type=WORK:;;22 Foo St;San Francisco;CA;94100;United States
      &#47;&#47; Format is ADR:&lt;pobox&gt;:&lt;extended address&gt;:&lt;street&gt;:&lt;locality (city)&gt;:
      &#47;&#47;    &lt;region (state&#47;province)&gt;:&lt;postal code&gt;:country
      &#47;&#47; The spec says first two should be empty to avoid problems, so we&#39;ll
      &#47;&#47; just ignore them.
      var addressParts = val.split(&#39;;&#39;);
      if (addressParts.length != 7) continue;
      final street = addressParts[2];
      final locality = addressParts[3];
      final region = addressParts[4];
      final postal = addressParts[5];
      final country = addressParts[6];
      var components = &lt;String&gt;[];
      if (street.isNotEmpty) {
        components.add(street.trim());
      }
      if (locality.isNotEmpty || region.isNotEmpty || postal.isNotEmpty) {
        &#47;&#47; e.g. San Francisco CA 94100
        &#47;&#47; e.g. Libourne 33500
        &#47;&#47; not perfect but good enough
        components
            .add([locality, region, postal].map((x) =&gt; x.trim()).join(&#39; &#39;));
      }
      if (country.isNotEmpty) components.add(country);
      if (components.isEmpty) continue;
      var address = Address(decode(components.join(&#39;\n&#39;)));
      for (var param in params) {
        if (param.key == &#39;TYPE&#39;) {
          if (param.value == &#39;HOME&#39;) {
            address.label = AddressLabel.home;
          } else if (param.value == &#39;WORK&#39;) {
            address.label = AddressLabel.work;
          }
        }
      }
      contact.addresses.add(address);
    } else if (op == &#39;ORG&#39;) {
      &#47;&#47; Format is ORG:&lt;company&gt;[;&lt;division&gt;[:&lt;subdivision&gt;...]]
      var org = decode(val.split(&#39;;&#39;)[0]);
      if (org.isEmpty) continue;
      if (contact.organizations.isEmpty) {
        contact.organizations = [Organization()];
      }
      contact.organizations.first.company = decode(org);
    } else if (op == &#39;TITLE&#39;) {
      &#47;&#47; Format is TITLE:&lt;title&gt;
      if (val.isEmpty) continue;
      if (contact.organizations.isEmpty) {
        contact.organizations = [Organization()];
      }
      contact.organizations.first.title = decode(val);
    } else if (op == &#39;URL&#39;) {
      &#47;&#47; URLs have types, but we ignore them for now
      if (val.isEmpty) continue;
      contact.websites.add(Website(decode(val)));
    } else if (op == &#39;IMPP&#39;) {
      &#47;&#47; IMPP;PREF=1:xmpp:alice@example.com
      &#47;&#47; IMPP:aim:johndoe@aol.com
      &#47;&#47; item7.IMPP;X-SERVICE-TYPE=Skype;type=pref:skype:skypehandle
      &#47;&#47; item7.X-ABLabel:Skype
      &#47;&#47; item8.IMPP;X-SERVICE-TYPE=QQ:x-apple:qqhandle
      &#47;&#47; item8.X-ABLabel:QQ
      var imParts = val.split(&#39;:&#39;);
      if (imParts.length != 2) continue;
      final name = imParts[1];
      final type = imParts[0].toLowerCase();
      if (name.isEmpty) continue;
      var label = SocialMediaLabel.custom;
      var customLabel = &#39;&#39;;
      switch (type) {
        case &#39;skype&#39;:
          label = SocialMediaLabel.skype;
          break;
        case &#39;snapchat&#39;:
          label = SocialMediaLabel.snapchat;
          break;
        case &#39;facebook&#39;:
          label = SocialMediaLabel.facebook;
          break;
        case &#39;twitter&#39;:
          label = SocialMediaLabel.twitter;
          break;
        case &#39;wechat&#39;:
          label = SocialMediaLabel.wechat;
          break;
        case &#39;qq&#39;:
        case &#39;qqchat&#39;:
          label = SocialMediaLabel.qqchat;
          break;
        case &#39;telegram&#39;:
          label = SocialMediaLabel.telegram;
          break;
        case &#39;discord&#39;:
          label = SocialMediaLabel.discord;
          break;
        case &#39;jabber&#39;:
          label = SocialMediaLabel.jabber;
          break;
        case &#39;yahoo&#39;:
          label = SocialMediaLabel.yahoo;
          break;
        case &#39;x-apple&#39;:
          customLabel = imParts[0];
          break;
        default:
          customLabel = type;
      }
      contact.socialMedias.add(
          SocialMedia(decode(name), label: label, customLabel: customLabel));
      break;
    } else if (op == &#39;X-SOCIALPROFILE&#39;) {
      &#47;&#47; X-SOCIALPROFILE;type=twitter:http:&#47;&#47;twitter.com&#47;twit
      &#47;&#47; X-SOCIALPROFILE;type=facebook:http:&#47;&#47;www.facebook.com&#47;fb
      if (val.isEmpty) continue;
      var label = SocialMediaLabel.custom;
      var customLabel = &#39;&#39;;
      for (var param in params) {
        if (param.key == &#39;TYPE&#39;) {
          var type = param.value.toLowerCase();
          switch (type) {
            case &#39;skype&#39;:
              label = SocialMediaLabel.skype;
              break;
            case &#39;snapchat&#39;:
              label = SocialMediaLabel.snapchat;
              break;
            case &#39;facebook&#39;:
              label = SocialMediaLabel.facebook;
              break;
            case &#39;twitter&#39;:
              label = SocialMediaLabel.twitter;
              break;
            case &#39;wechat&#39;:
              label = SocialMediaLabel.wechat;
              break;
            case &#39;qqchat&#39;:
              label = SocialMediaLabel.qqchat;
              break;
            case &#39;telegram&#39;:
              label = SocialMediaLabel.telegram;
              break;
            case &#39;discord&#39;:
              label = SocialMediaLabel.discord;
              break;
            case &#39;jabber&#39;:
              label = SocialMediaLabel.jabber;
              break;
            case &#39;yahoo&#39;:
              label = SocialMediaLabel.yahoo;
              break;
            default:
              customLabel = param.value;
          }
        }
      }
      if (label == null) continue;
      contact.socialMedias.add(
          SocialMedia(decode(val), label: label, customLabel: customLabel));
    } else if (op == &#39;PHOTO&#39;) {
      &#47;&#47; 2.1: PHOTO;JPEG:http:&#47;&#47;example.com&#47;photo.jpg
      &#47;&#47; 2.1: PHOTO;JPEG;ENCODING=BASE64:[base64-data]
      &#47;&#47; 3.0: PHOTO;TYPE=JPEG;VALUE=URI:http:&#47;&#47;example.com&#47;photo.jpg
      &#47;&#47; 3.0: PHOTO;TYPE=JPEG;ENCODING=b:[base64-data]
      &#47;&#47; 4.0: PHOTO;MEDIATYPE=image&#47;jpeg:http:&#47;&#47;example.com&#47;photo.jpg
      &#47;&#47; 4.0: PHOTO:data:image&#47;jpeg;base64,[base64-data]
      &#47;&#47; 3.0: PHOTO;ENCODING=b;TYPE=JPEG:[bytes]
      var encoding = &#39;&#39;;
      switch (version) {
        case Version.V2_1:
        case Version.V3:
          &#47;&#47; Not perfect, but will do for now.
          if (val.startsWith(&#39;http&#39;) || val.startsWith(&#39;ftp&#39;)) {
            &#47;&#47; not yet implemented
          } else {
            encoding = val;
          }
          break;
        case Version.V4:
          if (val.startsWith(&#39;http&#39;) || val.startsWith(&#39;ftp&#39;)) {
            &#47;&#47; not yet implemented
          } else {
            encoding = val.split(&#39;,&#39;).last;
          }
      }
      if (encoding.isEmpty) continue;
      photo = encoding;
      buildingPhoto = true;
    } else if (op == &#39;BDAY&#39;) {
      &#47;&#47; not yet implemented
    } else if (op == &#39;NOTES&#39;) {
      &#47;&#47; not yet implemented
    } else if (op == &#39;X-ABDATE&#39;) {
      &#47;&#47; not yet implemented
    } else if (op == &#39;X-ABRELATEDNAMES&#39;) {
      &#47;&#47; not yet implemented
    } else if (op == &#39;X-ALTBDAY&#39;) {
      &#47;&#47; not yet implemented
    } else if (op == &#39;NOTES&#39;) {
      &#47;&#47; not yet implemented
    } else if (op == &#39;X-ABLABEL&#39;) {
      &#47;&#47; currently ignored
    } else if (op == &#39;X-ABADR&#39;) {
      &#47;&#47; currently ignored
    }
  }
}</code></pre>
    </section>

  </div> <!-- /.main-content -->

  <div id="dartdoc-sidebar-right" class="col-xs-6 col-sm-6 col-md-2 sidebar sidebar-offcanvas-right">
  </div><!--/.sidebar-offcanvas-->

</main>

<footer>
  <span class="no-break">
    flutter_contacts
      0.1.1
  </span>

</footer>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="../../static-assets/typeahead.bundle.min.js"></script>
<script src="../../static-assets/highlight.pack.js"></script>
<script src="../../static-assets/URI.js"></script>
<script src="../../static-assets/script.js"></script>


</body>

</html>
